% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_butterfly_stacked_barplot.R
\name{plot_butterfly_stacked_barplot}
\alias{plot_butterfly_stacked_barplot}
\title{Butterfly Stacked Bar Plot for Adverse Event Grades}
\usage{
plot_butterfly_stacked_barplot(
  df_soc_pt,
  df_pat_grp,
  df_pat_soc_grade,
  ref_grp = NULL,
  max_text_width = 9,
  vec_fill_color = viridis::viridis(n = 4)
)
}
\arguments{
\item{df_soc_pt}{A data frame mapping system organ classes (SOC) to preferred terms (PT).
Must contain columns:
\itemize{
\item \code{soc} (character): System Organ Class.
\item \code{pt} (character): Preferred Term.
}}

\item{df_pat_grp}{A data frame with patient IDs and their assigned group.
Must contain columns:
\itemize{
\item \code{id_pat} (character): Patient ID.
\item \code{grp} (character): Group assignment (e.g., treatment arms).
}}

\item{df_pat_soc_grade}{A data frame linking patients to reported SOCs and AE grades.
Must contain columns:
\itemize{
\item \code{id_pat} (character): Patient ID.
\item \code{soc} (character): System Organ Class.
\item \code{grade} (numeric or factor): Grade of the adverse event.
}}

\item{ref_grp}{A character string specifying the reference group (used for alignment in the plot).
If NULL (default), the first level of \code{df_pat_grp$grp} is used.}

\item{max_text_width}{An integer specifying the maximum width (in characters) for SOC labels
before wrapping to the next line. Default is 9.}

\item{vec_fill_color}{A vector of colors used for filling the AE grade bars. Default is
\code{viridis::viridis(n = 4)}.}
}
\value{
A ggplot2 object representing the butterfly stacked bar plot.
}
\description{
Creates a butterfly stacked bar plot to visualize the frequency of adverse event (AE) grades
across patient groups, with system organ class (SOC) and preferred terms (PT) as labels.
}
\details{
The function processes input data to calculate the frequency of adverse events per patient
group and AE grade. It then generates a stacked bar plot where:
\itemize{
\item The x-axis represents the percentage of patients experiencing an AE.
\item The y-axis represents SOCs (with PTs as facets).
\item Bars are stacked by AE grade.
\item Labels for SOCs are displayed in the center.
\item The left and right panels correspond to different patient groups.
}

The function utilizes the \code{ggh4x} package to adjust panel sizes and axes for a symmetrical
butterfly plot.
}
\examples{
library(ggplot2)
library(dplyr)
library(forcats)
library(viridis)
library(ggh4x)

df_soc_pt <- data.frame(
  soc = c("Arrhythmia", "Myocardial Infarction", "Pneumonia", "Sepsis"),
  pt = c("Cardiac Disorders", "Cardiac Disorders", "Infections", "Infections")
)

df_pat_grp <- data.frame(id_pat = paste0("ID_", 1:10),
                         grp = c(rep("A", 5), rep("B", 5)))

df_pat_soc_grade <- data.frame(id_pat = c("ID_1", "ID_1", "ID_2", "ID_4", "ID_9"),
                         soc = c("Arrhythmia", "Myocardial Infarction", "Arrhythmia", 
                                 "Pneumonia", "Pneumonia"),
                         grade = c(4, 2, 1, 3, 4))

plot_butterfly_stacked_barplot(df_soc_pt, df_pat_grp, df_pat_soc_grade)

}
